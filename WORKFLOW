# WORKFLOW DE MIGRATION HIFI : REACT (FIGMA MAKE) VERS ASTRO

**Version :** 1.2 (Standardisation & S√©curit√©)
**Stack Cible :** Astro 5 (SSR) + Vercel + React + Tailwind v3 (Strict)
**Outil :** Gemini Code Assist (VS Code)

---

## üîÆ TROUBLESHOOTING & ANTICIPATION (LIRE AVANT DE COMMENCER)

Ceci liste les erreurs critiques rencontr√©es lors de la Session 1 et les proc√©dures pour les √©viter (Source: Agent Post-Mortem).

### üî¥ Probl√®me 1 : Commandes Git Destructrices

- **Sympt√¥me :** L'Agent lance un `git reset --hard` qui efface tout le travail non committ√© (comme cela s'est produit).
- **SOLUTION PR√âVENTIVE :**
  1.  **INTERDICTION FORMELLE** d'utiliser ou de sugg√©rer des commandes Git destructrices (`git reset --hard`, `git clean`).
  2.  Toujours utiliser `git restore .` (non destructif) pour annuler les changements locaux.
  3.  **TOUJOURS commiter** avant de lancer une mission majeure de l'Agent.

### üî¥ Probl√®me 2 : Conflit Tailwind v4 (L'erreur de l'installateur)

- **Sympt√¥me :** L'installation automatique installe la v4, incompatible avec le Legacy.
- **SOLUTION PR√âVENTIVE :** Installer Tailwind v3 manuellement et configurer l'int√©gration v3 dans `astro.config.mjs` avant de lancer la migration.

### üî¥ Probl√®me 3 : R√©gression Visuelle (Le "Gemini Interpretation")

- **Sympt√¥me :** L'Agent "nettoie" les classes complexes (gradients, ombres) et perd la fid√©lit√© Pixel-Perfect.
- **SOLUTION PR√âVENTIVE :**
  1.  Utiliser des prompts de **"Clonage Litt√©ral"** : forcer l'Agent √† copier les attributs `className` du Legacy.
  2.  Forcer la validation contre les **R√®gles Absolues** du `design-system.md` (ex: `font-weight: 400` sur Playfair).

### üî¥ Probl√®me 4 : Surcharge M√©moire de l'Agent (Timeout)

- **Sympt√¥me :** L'Agent plante en essayant de scanner le dossier `_LEGACY_REACT` entier en une seule fois.
- **SOLUTION PR√âVENTIVE :** Ne jamais demander une migration compl√®te en une seule commande. Utiliser des prompts ultra-cibl√©s (par Lot, par Fichier).

---

## üõ†Ô∏è WORKFLOW STANDARDIS√â (Proc√©dure Nominale)

### PHASE 1 : PR√âPARATION DU CONTEXTE

1.  **Isoler :** D√©placer le code source React vers `_LEGACY_REACT/`.
2.  **Contextualisation :** Placer les specs (`architecture.md`, `design-system.md`) dans `.gemini/specs/`.
3.  **Lock Config :** Installer Tailwind v3 manuellement et configurer `astro.config.mjs` (output: 'server').

### PHASE 2 : MIGRATION PAR LOTS (Clonage Int√©gral)

**R√®gle :** Utiliser le `Prompt de Clonage Int√©gral` (Style + Contenu) sur chaque page.

| Lot   | Type de Page                           | Strat√©gie                                                                                   |
| :---- | :------------------------------------- | :------------------------------------------------------------------------------------------ |
| **0** | **Layout Global** (Header, Footer)     | Clonage pur Astro (`.astro` statique)                                                       |
| **1** | **Vitrine** (Offre, M√©thode, √âtudes)   | Clonage HTML/CSS strict + `<Reveal client:visible>`.                                        |
| **2** | **L√©gal** (CGV, Mentions)              | Copie de texte int√©gral + Layout.                                                           |
| **3** | **Apps** (Contact, Audit, R√©servation) | Extraction de la logique React dans `src/components/islands/` et hydratation `client:load`. |

### PHASE 3 : OPTIMISATION 100/100 (FINITION)

1.  **Images :** Remplacer `<img>` par `<Image />` (`astro:assets`).
2.  **Polices :** Remplacer les CDN par `@fontsource`.
3.  **Hydratation :** V√©rifier que `client:load` n'est utilis√© que l√† o√π c'est n√©cessaire.
4.  **Lighthouse :** Validation finale du score.

---

Veuillez cr√©er ce fichier. Ensuite, relan√ßons la reconstruction des pages perdues (Phase 2, Lot 1) avec cette m√©thodologie !
